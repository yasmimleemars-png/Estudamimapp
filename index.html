<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Cronograma de Estudos - Concurso</title>
    <style>
        :root {
            --primary-color: #6c5ce7;
            --secondary-color: #a29bfe;
            --bg-color: #f4f7f6;
            --text-color: #2d3436;
            --white: #ffffff;
            --shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
            --radius: 12px;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background-color: var(--bg-color);
            color: var(--text-color);
            margin: 0;
            padding: 20px;
            display: flex;
            flex-direction: column;
            align-items: center;
        }

        h1 {
            color: var(--primary-color);
            margin-bottom: 20px;
        }

        /* Painel de Controles */
        .controls {
            background: var(--white);
            padding: 20px;
            border-radius: var(--radius);
            box-shadow: var(--shadow);
            margin-bottom: 20px;
            display: flex;
            flex-wrap: wrap;
            gap: 15px;
            justify-content: center;
            align-items: center;
            width: 100%;
            max-width: 1000px;
        }

        .nav-controls {
            display: flex;
            gap: 10px;
            border-left: 2px solid #eee;
            padding-left: 15px;
            margin-left: 10px;
        }

        @media (max-width: 800px) {
            .nav-controls {
                border-left: none;
                padding-left: 0;
                margin-left: 0;
                width: 100%;
                justify-content: center;
            }
        }

        select, button, input {
            padding: 10px 15px;
            border: 1px solid #ddd;
            border-radius: 8px;
            font-size: 14px;
            outline: none;
        }

        button {
            background-color: var(--primary-color);
            color: white;
            border: none;
            cursor: pointer;
            transition: background 0.3s;
            font-weight: 600;
        }

        button:hover {
            background-color: #5649c0;
        }

        button.secondary {
            background-color: var(--secondary-color);
        }
        
        button.nav-btn {
            background-color: #dfe6e9;
            color: #2d3436;
        }
        
        button.nav-btn:hover {
            background-color: #b2bec3;
        }

        /* √Årea do Calend√°rio */
        .calendar-container {
            display: grid;
            grid-template-columns: repeat(7, 1fr);
            gap: 10px;
            width: 100%;
            max-width: 1200px;
        }

        .day-header {
            text-align: center;
            font-weight: bold;
            color: #636e72;
            padding: 10px;
        }

        .day-cell {
            background: var(--white);
            border-radius: var(--radius);
            padding: 10px;
            min-height: 120px;
            box-shadow: var(--shadow);
            position: relative;
            display: flex;
            flex-direction: column;
            gap: 5px;
        }

        .day-number {
            font-weight: bold;
            margin-bottom: 5px;
            color: #b2bec3;
        }
        
        .is-today {
            border: 2px solid var(--primary-color);
        }

        .study-block {
            padding: 5px 8px;
            border-radius: 6px;
            font-size: 11px;
            color: #333;
            cursor: pointer;
            display: flex;
            justify-content: space-between;
            align-items: center;
            font-weight: 500;
            box-shadow: 0 1px 2px rgba(0,0,0,0.1);
        }

        .study-block:hover {
            opacity: 0.9;
        }

        .remove-btn {
            background: none;
            border: none;
            color: #444;
            font-weight: bold;
            font-size: 14px;
            padding: 0 0 0 5px;
        }

        .remove-btn:hover {
            color: red;
        }

        /* Estilos para visualiza√ß√£o Anual */
        .year-view {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(250px, 1fr));
            gap: 20px;
            width: 100%;
            max-width: 1200px;
        }

        .month-card {
            background: var(--white);
            border-radius: var(--radius);
            padding: 15px;
            box-shadow: var(--shadow);
        }

        .month-title {
            text-align: center;
            font-weight: bold;
            margin-bottom: 10px;
            color: var(--primary-color);
        }

        .month-grid {
            display: grid;
            grid-template-columns: repeat(7, 1fr);
            gap: 2px;
            font-size: 10px;
        }

        .month-day {
            text-align: center;
            padding: 4px 0;
            background: #eee;
            border-radius: 2px;
        }
        
        .has-study {
            background-color: var(--secondary-color);
            color: white;
            font-weight: bold;
        }

        /* Estilos para visualiza√ß√£o Semanal */
        .week-view {
            display: flex;
            gap: 15px;
            width: 100%;
            max-width: 1200px;
            overflow-x: auto;
            padding-bottom: 20px;
        }

        .week-day-col {
            flex: 1;
            min-width: 140px;
            background: var(--white);
            border-radius: var(--radius);
            padding: 10px;
            box-shadow: var(--shadow);
        }

        .week-day-title {
            text-align: center;
            font-weight: bold;
            margin-bottom: 10px;
            border-bottom: 2px solid #f0f0f0;
            padding-bottom: 10px;
        }

    </style>
</head>
<body>

    <h1>üìÖ Meu Cronograma de Estudos</h1>

    <div class="controls">
        <select id="subjectSelect">
            </select>
        <input type="text" id="customSubject" placeholder="Ou digite nova...">
        <input type="date" id="studyDate">
        <button onclick="addStudyBlock()">+ Adicionar</button>
        
        <button class="secondary" onclick="exportData()">üíæ Salvar</button>
        <button class="secondary" onclick="document.getElementById('fileInput').click()">üìÇ Carregar</button>
        <input type="file" id="fileInput" style="display: none;" onchange="importData(this)">

        <div class="nav-controls">
            <select id="viewSelect" onchange="changeView()">
                <option value="weekly">Semanal</option>
                <option value="monthly" selected>Mensal</option>
                <option value="yearly">Anual</option>
            </select>
            
            <button class="nav-btn" onclick="changePeriod(-1)">‚óÄ</button>
            <button class="nav-btn" onclick="goToToday()">Hoje</button>
            <button class="nav-btn" onclick="changePeriod(1)">‚ñ∂</button>
        </div>
    </div>

    <h2 id="currentPeriodLabel"></h2>
    
    <div id="calendar" class="calendar-container"></div>
    <div id="yearContainer" class="year-view" style="display: none;"></div>
    <div id="weekContainer" class="week-view" style="display: none;"></div>

    <script>
        // Lista Atualizada (Sem Matem√°tica, Com novas mat√©rias)
        const defaultSubjects = [
            "L√≠ngua Portuguesa", 
            "Racioc√≠nio L√≥gico", 
            "Atualidades", 
            "Inform√°tica", 
            "Medicina Legal", 
            "Legisla√ß√£o Geral", 
            "Direito Administrativo", 
            "Direito Constitucional", 
            "Direito Penal", 
            "Direito Processual Penal", 
            "Legisla√ß√£o Extravagante", 
            "Arquivologia", 
            "Simulados"
        ];

        // Paleta Expandida (Cores Past√©is)
        const subjectColors = {
            "L√≠ngua Portuguesa": "#ffadad",
            "Racioc√≠nio L√≥gico": "#ffd6a5",
            "Atualidades": "#fdffb6",
            "Inform√°tica": "#caffbf",
            "Medicina Legal": "#9bf6ff",
            "Legisla√ß√£o Geral": "#a0c4ff",
            "Direito Administrativo": "#bdb2ff",
            "Direito Constitucional": "#ffc6ff",
            "Direito Penal": "#fffffc",
            "Direito Processual Penal": "#e7cba9",
            "Legisla√ß√£o Extravagante": "#e2f0cb",
            "Arquivologia": "#b5ead7",
            "Simulados": "#ff9aa2"
        };

        function getSubjectColor(subject) {
            if (subjectColors[subject]) return subjectColors[subject];
            // Cor padr√£o aleat√≥ria para novas
            return '#dfe6e9'; 
        }

        let studyData = JSON.parse(localStorage.getItem('studyData')) || [];
        
        // Estado da visualiza√ß√£o (Data que est√° sendo exibida)
        let viewDate = new Date();

        // Inicializa√ß√£o
        function init() {
            populateSubjectSelect();
            document.getElementById('studyDate').valueAsDate = new Date();
            renderView();
        }

        function populateSubjectSelect() {
            const select = document.getElementById('subjectSelect');
            select.innerHTML = '<option value="">Selecione a Disciplina...</option>';
            defaultSubjects.forEach(subj => {
                const option = document.createElement('option');
                option.value = subj;
                option.textContent = subj;
                select.appendChild(option);
            });
        }

        function addStudyBlock() {
            const selectVal = document.getElementById('subjectSelect').value;
            const customVal = document.getElementById('customSubject').value;
            const dateVal = document.getElementById('studyDate').value;
            
            const subject = customVal || selectVal;

            if (!subject || !dateVal) {
                alert("Selecione disciplina e data.");
                return;
            }

            studyData.push({
                id: Date.now(),
                subject: subject,
                date: dateVal
            });

            saveLocal();
            document.getElementById('customSubject').value = '';
            renderView();
        }

        function removeStudy(id) {
            if(confirm("Deseja remover este estudo?")) {
                studyData = studyData.filter(item => item.id !== id);
                saveLocal();
                renderView();
            }
        }

        function saveLocal() {
            localStorage.setItem('studyData', JSON.stringify(studyData));
        }

        /* --- Navega√ß√£o e Visualiza√ß√£o --- */

        function goToToday() {
            viewDate = new Date();
            document.getElementById('studyDate').valueAsDate = viewDate;
            renderView();
        }

        function changePeriod(offset) {
            const view = document.getElementById('viewSelect').value;
            
            if (view === 'monthly') {
                viewDate.setMonth(viewDate.getMonth() + offset);
            } else if (view === 'yearly') {
                viewDate.setFullYear(viewDate.getFullYear() + offset);
            } else if (view === 'weekly') {
                viewDate.setDate(viewDate.getDate() + (offset * 7));
            }
            renderView();
        }

        function changeView() {
            renderView();
        }

        function renderView() {
            const view = document.getElementById('viewSelect').value;
            const calDiv = document.getElementById('calendar');
            const yearDiv = document.getElementById('yearContainer');
            const weekDiv = document.getElementById('weekContainer');
            const label = document.getElementById('currentPeriodLabel');

            calDiv.style.display = 'none';
            yearDiv.style.display = 'none';
            weekDiv.style.display = 'none';

            if (view === 'monthly') {
                calDiv.style.display = 'grid';
                label.textContent = viewDate.toLocaleDateString('pt-BR', { month: 'long', year: 'numeric' });
                renderCalendar();
            } else if (view === 'yearly') {
                yearDiv.style.display = 'grid';
                label.textContent = `Ano de ${viewDate.getFullYear()}`;
                renderYearly();
            } else if (view === 'weekly') {
                weekDiv.style.display = 'flex';
                // Pega o in√≠cio e fim da semana para o r√≥tulo
                const startOfWeek = new Date(viewDate);
                startOfWeek.setDate(viewDate.getDate() - viewDate.getDay());
                const endOfWeek = new Date(startOfWeek);
                endOfWeek.setDate(startOfWeek.getDate() + 6);
                
                label.textContent = `Semana: ${startOfWeek.getDate()}/${startOfWeek.getMonth()+1} a ${endOfWeek.getDate()}/${endOfWeek.getMonth()+1}`;
                renderWeekly();
            }
        }

        // --- Renderiza√ß√£o Mensal ---
        function renderCalendar() {
            const container = document.getElementById('calendar');
            container.innerHTML = '';

            const daysOfWeek = ['Dom', 'Seg', 'Ter', 'Qua', 'Qui', 'Sex', 'S√°b'];
            daysOfWeek.forEach(day => {
                const div = document.createElement('div');
                div.className = 'day-header';
                div.textContent = day;
                container.appendChild(div);
            });

            const year = viewDate.getFullYear();
            const month = viewDate.getMonth();

            const firstDay = new Date(year, month, 1).getDay();
            const daysInMonth = new Date(year, month + 1, 0).getDate();
            const todayStr = new Date().toISOString().split('T')[0];

            // C√©lulas vazias
            for (let i = 0; i < firstDay; i++) {
                container.appendChild(document.createElement('div'));
            }

            // Dias
            for (let day = 1; day <= daysInMonth; day++) {
                const dateStr = `${year}-${String(month + 1).padStart(2, '0')}-${String(day).padStart(2, '0')}`;
                
                const cell = document.createElement('div');
                cell.className = 'day-cell';
                if(dateStr === todayStr) cell.classList.add('is-today');
                
                const dayNum = document.createElement('div');
                dayNum.className = 'day-number';
                dayNum.textContent = day;
                cell.appendChild(dayNum);

                const daysStudies = studyData.filter(s => s.date === dateStr);
                daysStudies.forEach(study => {
                    const block = document.createElement('div');
                    block.className = 'study-block';
                    block.style.backgroundColor = getSubjectColor(study.subject);
                    block.innerHTML = `<span>${study.subject}</span> <button class="remove-btn" onclick="removeStudy(${study.id})">√ó</button>`;
                    cell.appendChild(block);
                });

                container.appendChild(cell);
            }
        }

        // --- Renderiza√ß√£o Anual ---
        function renderYearly() {
            const container = document.getElementById('yearContainer');
            container.innerHTML = '';
            const months = ['Jan', 'Fev', 'Mar', 'Abr', 'Mai', 'Jun', 'Jul', 'Ago', 'Set', 'Out', 'Nov', 'Dez'];
            const year = viewDate.getFullYear();

            months.forEach((mName, index) => {
                const card = document.createElement('div');
                card.className = 'month-card';
                
                const title = document.createElement('div');
                title.className = 'month-title';
                title.textContent = mName;
                card.appendChild(title);

                const grid = document.createElement('div');
                grid.className = 'month-grid';

                const daysInM = new Date(year, index + 1, 0).getDate();
                
                for(let d=1; d<=daysInM; d++) {
                    const dStr = `${year}-${String(index + 1).padStart(2, '0')}-${String(d).padStart(2, '0')}`;
                    const hasStudy = studyData.some(s => s.date === dStr);
                    
                    const dayEl = document.createElement('div');
                    dayEl.className = 'month-day ' + (hasStudy ? 'has-study' : '');
                    dayEl.textContent = d;
                    grid.appendChild(dayEl);
                }
                card.appendChild(grid);
                container.appendChild(card);
            });
        }

        // --- Renderiza√ß√£o Semanal ---
        function renderWeekly() {
            const container = document.getElementById('weekContainer');
            container.innerHTML = '';
            
            const daysOfWeek = ['Domingo', 'Segunda', 'Ter√ßa', 'Quarta', 'Quinta', 'Sexta', 'S√°bado'];
            const todayStr = new Date().toISOString().split('T')[0];

            // Calcular o Domingo da semana visualizada
            const startOfWeek = new Date(viewDate);
            startOfWeek.setDate(viewDate.getDate() - viewDate.getDay());

            for (let i = 0; i < 7; i++) {
                // Clona a data para n√£o alterar a refer√™ncia
                const currentDay = new Date(startOfWeek);
                currentDay.setDate(startOfWeek.getDate() + i);
                
                const isoDate = currentDay.toISOString().split('T')[0];
                
                const col = document.createElement('div');
                col.className = 'week-day-col';
                if(isoDate === todayStr) col.style.border = "2px solid var(--primary-color)";
                
                const title = document.createElement('div');
                title.className = 'week-day-title';
                title.innerHTML = `${daysOfWeek[i]} <br> <small>${currentDay.getDate()}/${currentDay.getMonth()+1}</small>`;
                col.appendChild(title);

                const daysStudies = studyData.filter(s => s.date === isoDate);
                daysStudies.forEach(study => {
                    const block = document.createElement('div');
                    block.className = 'study-block';
                    block.style.marginBottom = '5px';
                    block.style.backgroundColor = getSubjectColor(study.subject);
                    block.innerHTML = `<span>${study.subject}</span> <button class="remove-btn" onclick="removeStudy(${study.id})">√ó</button>`;
                    col.appendChild(block);
                });

                container.appendChild(col);
            }
        }

        // --- Importar/Exportar ---
        function exportData() {
            const dataStr = JSON.stringify(studyData);
            const blob = new Blob([dataStr], {type: "application/json"});
            const url = URL.createObjectURL(blob);
            const a = document.createElement('a');
            a.href = url;
            a.download = "meus_estudos.json";
            a.click();
        }

        function importData(input) {
            const file = input.files[0];
            if (!file) return;
            const reader = new FileReader();
            reader.onload = function(e) {
                try {
                    studyData = JSON.parse(e.target.result);
                    saveLocal();
                    renderView();
                    alert("Dados carregados!");
                } catch (err) {
                    alert("Erro ao ler arquivo.");
                }
            };
            reader.readAsText(file);
        }

        init();
    </script>
</body>
</html>
